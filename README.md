# Overview

> Generated by [`ZenStack-markdown`](https://github.com/jiashengguo/zenstack-markdown)

This application is designed to manage collaborative spaces where users can create and manage lists and todos within those spaces. It provides a structured environment for task management, team collaboration, and personal organization within a shared context.

## Functionality

The app allows users to:
- Create and manage personal and shared spaces.
- Invite members to spaces with different roles (USER or ADMIN).
- Create lists within spaces, which can be private or public.
- Add todos to lists, track their completion status.
- Control access to spaces, lists, and todos based on user roles and ownership.

Models:

- [Space](#Space)
- [SpaceUser](#SpaceUser)
- [User](#User)
- [List](#List)
- [Todo](#Todo)

## Space
```mermaid
erDiagram
"Space" {
  String id PK 
  DateTime createdAt  
  DateTime updatedAt  
  String name  
  String slug  
}
"Space" ||--o{ "SpaceUser": members
"Space" ||--o{ "List": lists
```
- @@deny('all', auth() == null)
- @@allow('create', true)
- @@allow('read', members?[user == auth()])
- @@allow('update,delete', members?[user == auth() && role == ADMIN])
## SpaceUser
```mermaid
erDiagram
"SpaceUser" {
  String id PK 
  DateTime createdAt  
  DateTime updatedAt  
  String spaceId FK 
  String userId FK 
  SpaceUserRole role  
}
"SpaceUser" }o--|| "Space": space
"SpaceUser" }o--|| "User": user
```
- @@deny('all', auth() == null)
- @@allow('create,update,delete', space.members?[user == auth() && role == ADMIN])
- @@allow('read', space.members?[user == auth()])
## User
```mermaid
erDiagram
"User" {
  String id PK 
  DateTime createdAt  
  DateTime updatedAt  
  String email  
  DateTime emailVerified  "?"
  String password  "?"
  String name  "?"
  String image  "?"
}
"User" ||--o{ "SpaceUser": spaces
"User" ||--o{ "List": lists
"User" ||--o{ "Todo": todos
```
- @@allow('create', true)
- @@allow('read', spaces?[space.members?[user == auth()]])
- @@allow('all', auth() == this)
## List
```mermaid
erDiagram
"List" {
  String id PK 
  DateTime createdAt  
  DateTime updatedAt  
  String spaceId FK 
  String ownerId FK 
  String title  
  Boolean private  
}
"List" }o--|| "Space": space
"List" }o--|| "User": owner
"List" ||--o{ "Todo": todos
```
- @@deny('all', auth() == null)
- @@allow('read', owner == auth() || (space.members?[user == auth()] && !private))
- @@allow('create', owner == auth() && space.members?[user == auth()])
- @@allow('update', owner == auth() && space.members?[user == auth()] && future().owner == owner)
- @@allow('delete', owner == auth())
## Todo
```mermaid
erDiagram
"Todo" {
  String id PK 
  DateTime createdAt  
  DateTime updatedAt  
  String ownerId FK 
  String listId FK 
  String title  
  DateTime completedAt  "?"
}
"Todo" }o--|| "User": owner
"Todo" }o--|| "List": list
```
- @@deny('all', auth() == null)
- @@allow('all', list.owner == auth())
- @@allow('all', list.space.members?[user == auth()] && !list.private)
- @@deny('update', future().owner != owner)
